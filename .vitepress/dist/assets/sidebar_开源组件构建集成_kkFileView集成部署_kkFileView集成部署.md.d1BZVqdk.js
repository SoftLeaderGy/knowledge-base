import{_ as i,c as a,o as n,a4 as l}from"./chunks/framework.CujM31lN.js";const h="/assets/1700550335889-23624495-0d0f-43bc-b789-cebd8a1fe751.DuFRGsfd.png",k="/assets/1700638945144-3b276d4e-90dc-471a-9a19-0336eff34127.B3TqQ5s7.png",s="/assets/1700720619683-d7bde0f2-fcc8-4f36-86c7-fc42311965f9._Jp-ciZG.png",C=JSON.parse('{"title":"一、准备","description":"","frontmatter":{},"headers":[],"relativePath":"sidebar/开源组件构建集成/kkFileView集成部署/kkFileView集成部署.md","filePath":"sidebar/开源组件构建集成/kkFileView集成部署/kkFileView集成部署.md","lastUpdated":1713767287000}'),t={name:"sidebar/开源组件构建集成/kkFileView集成部署/kkFileView集成部署.md"},p=l('<h1 id="一、准备" tabindex="-1">一、准备 <a class="header-anchor" href="#一、准备" aria-label="Permalink to &quot;一、准备&quot;">​</a></h1><ul><li>代码获取 <a href="https://gitee.com/kekingcn/file-online-preview" target="_blank" rel="noreferrer">https://gitee.com/kekingcn/file-online-preview</a></li><li>官网 <a href="https://kkfileview.keking.cn/zh-cn/index.html" target="_blank" rel="noreferrer">https://kkfileview.keking.cn/zh-cn/index.html</a></li></ul><h1 id="二、获取kkfileview安装包" tabindex="-1">二、获取kkFileView安装包 <a class="header-anchor" href="#二、获取kkfileview安装包" aria-label="Permalink to &quot;二、获取kkFileView安装包&quot;">​</a></h1><ul><li>降代码拉取至本地</li><li>配置环境后，点击maven install</li><li>会在项目的根目录下<code>server/target/</code>下生成两个压缩包</li><li><img src="'+h+'" alt="image.png"></li><li><code>.zip</code>为windows版本，<code>.tar.gz</code>为linux版本</li></ul><h1 id="三、部署-以linux为例" tabindex="-1">三、部署（以linux为例） <a class="header-anchor" href="#三、部署-以linux为例" aria-label="Permalink to &quot;三、部署（以linux为例）&quot;">​</a></h1><h2 id="_3-1、jar包形式部署" tabindex="-1">3.1、jar包形式部署 <a class="header-anchor" href="#_3-1、jar包形式部署" aria-label="Permalink to &quot;3.1、jar包形式部署&quot;">​</a></h2><ul><li>将生成的<code>.tar.gz</code>压缩包上传至linux服务器上</li><li>使用<code>tar -zxvf xxxx.tar.gz</code>进行解压</li><li>解压后 进入文件夹会有4文件夹</li><li><img src="'+k+'" alt="image.png"></li><li>进入bin目录</li><li>可以看到一些<code>sh</code>脚本、一个<code>jar</code>包</li><li><img src="'+s+'" alt="image.png"></li><li>通过<code>sh startup.sh</code>进行启动viewFile 程序</li><li>第一次启动时回去下载offic相关的插件，会比较慢</li><li>命令执行完成后，可以通过<code>sh showlog.sh</code>进行程序的日志查看</li></ul><h2 id="_3-2、docker-方式部署" tabindex="-1">3.2、Docker 方式部署 <a class="header-anchor" href="#_3-2、docker-方式部署" aria-label="Permalink to &quot;3.2、Docker 方式部署&quot;">​</a></h2><ul><li>拉取镜像 <code>docker pull keking/kkfileview:4.1.0</code></li><li>如果网络环境不方便访问docker中央仓库可使用 <ul><li><code>wget [http://kkfileview.keking.cn/kkFileView-4.1.0-docker.tar](http://kkfileview.keking.cn/kkFileView-4.1.0-docker.tar)</code></li><li><code>docker load -i kkFileView-4.1.0-docker.tar</code></li></ul></li><li>运行 <ul><li><code>docker run -it-p8012:8012 keking/kkfileview:4.1.0</code></li><li>或使用 <code>-d</code>参数进行后台运行<code>docker run -itd -p8012:8012 keking/kkfileview:4.1.0</code></li></ul></li><li>查看日志 <ul><li><code>docker logs -f--tail 容器ID</code></li></ul></li></ul><h2 id="_3-3、可能遇到的问题" tabindex="-1">3.3、可能遇到的问题 <a class="header-anchor" href="#_3-3、可能遇到的问题" aria-label="Permalink to &quot;3.3、可能遇到的问题&quot;">​</a></h2><h3 id="_3-3-1、-找不到office组件-请确认-office-home-配置是否有误" tabindex="-1">3.3.1、“找不到office组件，请确认’office.home’配置是否有误” <a class="header-anchor" href="#_3-3-1、-找不到office组件-请确认-office-home-配置是否有误" aria-label="Permalink to &quot;3.3.1、“找不到office组件，请确认’office.home’配置是否有误”&quot;">​</a></h3><blockquote><p>在启动服务的时候，会遇到报错“找不到office组件，请确认’office.home’配置是否有误”的情况，原因是因为我们的viewfile程序是需要office插件的支持才行，但是绝大部份linux服务器上并没有安装office插件的，需要我们自己来安装。</p></blockquote><ol><li>其实<code>3.1</code>的步骤3中看到的<code>bin</code>文件夹中，会有一些文件 <ul><li><img src="'+s+`" alt="image.png"></li><li><code>KKFileView.xxx.jar</code>在线预览程序包，也就是说在线预览功能需要他来支撑。</li><li><code>showlog.sh</code> 查看预览程序日志脚本。</li><li><code>shutdown.sh</code> 停止预览程序。</li><li><code>startup.sh</code> 启动预览程序</li></ul></li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DIR_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/opt/openoffice.org3&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/opt/libreoffice&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/opt/libreoffice6.1&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/opt/libreoffice7.0&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/opt/libreoffice7.1&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/opt/libreoffice7.2&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/opt/libreoffice7.3&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/opt/libreoffice7.4&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/opt/openoffice4&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/usr/lib/openoffice&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/usr/lib/libreoffice&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FLAG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">OFFICE_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">KKFILEVIEW_BIN_FOLDER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">$(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dirname</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;)&quot; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> exit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pwd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PID_FILE_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;kkFileView.pid&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PID_FILE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">KKFILEVIEW_BIN_FOLDER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}/\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PID_FILE_NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> KKFILEVIEW_BIN_FOLDER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$KKFILEVIEW_BIN_FOLDER</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">## 如pid文件不存在则自动创建</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> \${PID_FILE_NAME} ]; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">then</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  touch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">KKFILEVIEW_BIN_FOLDER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}/\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PID_FILE_NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fi</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">## 判断当前是否有进程处于运行状态</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PID_FILE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ]; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">then</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  PID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PID_FILE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&quot;)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;进程已处于运行状态，进程号为：\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  exit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$KKFILEVIEW_BIN_FOLDER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ||</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> exit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Using KKFILEVIEW_BIN_FOLDER </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$KKFILEVIEW_BIN_FOLDER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;office\\.home&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ../config/application.properties</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;!^#&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$?</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -eq</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ]; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">then</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Using customized office.home&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  else</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> \${DIR_HOME[@]}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    do</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/program/soffice.bin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ]; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">then</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        FLAG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        OFFICE_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">\${i}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        break</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      fi</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    done</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FLAG</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ]; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">then</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Installing LibreOffice&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./install.sh</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    else</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Detected office component has been installed in </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$OFFICE_HOME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    fi</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  ## 启动kkFileView</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Starting kkFileView...&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  nohup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> java</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Dfile.encoding=UTF-8</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Dspring.config.location=../config/application.properties</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -jar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kkFileView-4.4.0-SNAPSHOT.jar</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ../log/kkFileView.log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> 2&gt;&amp;1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Please execute ./showlog.sh to check log for more information&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;You can get help in our official home site: https://kkview.cn&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;If you need further help, please join our kk opensource community: https://t.zsxq.com/09ZHSXbsQ&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;If this project is helpful to you, please star it on https://gitee.com/kekingcn/file-online-preview/stargazers&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  PROCESS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ps</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -ef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kkFileView </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> awk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;NR==1{print $2}&#39;)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 启动成功后将进程号写入pid文件</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PROCESS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PID_FILE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fi</span></span></code></pre></div><ul><li>可以看到在<code>startup.sh</code>36行，回去主动执行一下，install.sh 文件，也就是说我们只需要启动<code>startup.sh</code>就可以了</li><li><code>install.sh</code> 下载所需office插件脚本</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">install_redhat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://downloadarchive.documentfoundation.org/libreoffice/old/7.5.3.2/rpm/x86_64/LibreOffice_7.5.3.2_Linux_x86-64_rpm.tar.gz</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -cO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LibreOffice_7_rpm.tar.gz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -zxf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp/LibreOffice_7_rpm.tar.gz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp/LibreOffice_7.5.3.2_Linux_x86-64_rpm/RPMS</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   echo</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> $?</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$?</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -eq</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ];</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">then</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> libSM.x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> libXrender.x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  libXext.x86_64</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> groupinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;X Window System&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localinstall</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.rpm</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;install finshed...&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   else</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;download package error...&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   fi</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">install_ubuntu</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://downloadarchive.documentfoundation.org/libreoffice/old/7.5.3.2/deb/x86_64/LibreOffice_7.5.3.2_Linux_x86-64_deb.tar.gz</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -cO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LibreOffice_7_deb.tar.gz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -zxf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp/LibreOffice_7_deb.tar.gz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp/LibreOffice_7.5.3.2_Linux_x86-64_deb/DEBS</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   echo</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> $?</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$?</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -eq</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ];</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">then</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> libxinerama1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> libcairo2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> libcups2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> libx11-xcb1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     dpkg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.deb</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;install finshed...&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  else</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;download package error...&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fi</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/etc/redhat-release&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ]; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">then</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wget</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  install_redhat</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wget</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  install_ubuntu</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fi</span></span></code></pre></div><ol start="2"><li>但是在执行后启动的时候一样会报错：找不到office组件，请确认’office.home’配置是否有误，</li><li>我们通过<code>cd /tmp/LibreOffice_7.1.4.2_Linux_x86-64_rpm/RPMS</code>（注意LibreOffice的版本号）</li><li>执行<code>yum localinstall *.rpm -y</code>进行安装</li><li>再次回到<code>bin</code>文件夹执行<code>sh startup.sh</code>即可启动</li></ol><h3 id="_3-3-2、-在cd-tmp-libreoffice-7-1-4-2-linux-x86-64-rpm-rpms-过程中-找不到文件夹" tabindex="-1">3.3.2、“在cd /tmp/LibreOffice_7.1.4.2_Linux_x86-64_rpm/RPMS 过程中，找不到文件夹” <a class="header-anchor" href="#_3-3-2、-在cd-tmp-libreoffice-7-1-4-2-linux-x86-64-rpm-rpms-过程中-找不到文件夹" aria-label="Permalink to &quot;3.3.2、“在cd /tmp/LibreOffice_7.1.4.2_Linux_x86-64_rpm/RPMS 过程中，找不到文件夹”&quot;">​</a></h3><ul><li>找不到文件夹的原因 可能是因为服务器的网络问题，没有下载下来。</li><li>打开<code>资源压缩包</code>，会有一个<code>LibreOffice_7_rpm.tar.gz</code></li><li>将压缩包上传至服务器的 <code>/tmp</code>位置</li><li>使用<code>tar -zxvf xxxx.tar.gz</code>进行解压</li><li>执行 3.3.1.3步骤</li></ul>`,19),e=[p];function F(r,d,g,o,E,c){return n(),a("div",null,e)}const B=i(t,[["render",F]]);export{C as __pageData,B as default};
